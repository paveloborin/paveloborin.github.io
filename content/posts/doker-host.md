---
title: "Про путаницу с хостами при использовании контейнеров"
date: 2018-07-30T12:30:57+05:00
draft: false
tags: ["docker", "kubernetes","troubles"]
---
**Задача:**

Необходимо развернуть через Kubernetes контейнер с новой апи. 
Апи слушает порт 8000, внешний запрос к контейнеру должен быть переадресован на этот порт и вызов отдаваться апи. 

До этого задача развернуть новую апи в Kubernetes не вызывала никаких трудностей.
Однако в новой апи я впервые использовал фреймворк go-swagger, и на спецификациях кубернетиса, работающих для прежних апи, новая апи по каким-то непонятным причинам не взлетела. 

При запуске сервиса с апи Kubernetes во время проверки жизнеспособности сервиса не может достучаться до апи по указанному порту.  
По всем признакам порт в контейнере открыт, но в ответ приходит _nothing data_. 
Все выглядит так, словно внутри контейнера на этом порту нет никакой апи.
При заходе в контейнер и вызова через curl http://127.0.0.1:8000 вызов корректно обрабатывает запущенная в нем апи. 

Вывод: по каким-то причинам запрос, не смотря на то что он проходит в контейнер, в саму апи не доходит. 


**Выявленная ошибка:**

Апи слушала 127.0.0.1:8000, а нужно было 0.0.0.0:8000

В контейнере апи должна слушать не localhost (127.0.0.1), а 0.0.0.0 так все внешние запросы к контейнеру передаются именно на него.  
